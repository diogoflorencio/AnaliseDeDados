---
title: "Problema 1 - Checkpoint 4 AD1 UFCG"
author: "Diogo Florêncio"
output:
  html_notebook:
    theme: readable
    toc: true
    toc_float: true
    fig_width: 5
    fig_height: 4
editor_options: 
  chunk_output_type: inline
---


```{r}
library(tidyr)
library(dplyr)
library(ggplot2)
dados <- read.csv("series_from_imdb.csv",encoding="UTF-8")
```

# Qual série tem a temporada mais irregular?
Uma temporada irregular seria uma temporada na qual seus episódios tem avaliação bastante variada. Essa variação se diferencia da variação esperada para avaliação dos episódios de uma temporada, deste modo indicando a falta de regularidade na qualidade da série.  
```{r}
temporada_irregular <-dados %>% 
  group_by(serie = series_name)%>%
  summarise(variancia = var(UserRating))%>%
  top_n(10)
temporada_irregular%>% 
  ggplot(aes(x = serie, y = variancia, fill = serie)) + 
  geom_col(width = 0.7, ) + 
  scale_y_continuous(breaks=seq(0, 10, 1)) +
  coord_flip()

```
Qual série possui a melhor temporada?
```{r}
melhor_temporada <- dados %>% 
    group_by(series_name, season) %>% 
    summarise(mediana = median(UserRating),
              variancia = var(UserRating)) %>%
  arrange(desc(mediana),variancia)
```


#Qual a melhor série?
A melhor série deve ter maior regularidade entre os episódios e também episódios bem avaliadas. Seguindo esses critérios, séries com menos temporadas tem mais chances de serem avaliadas como melhor.
```{r}
melhor_serie <- dados %>% 
    group_by(serie = series_name) %>% 
    summarise(mediana = median(UserRating),
              variancia = var(UserRating)) %>%
    arrange(desc(mediana),variancia)%>%
    slice(1:10)
melhor_serie%>% 
  mutate(season = as.character(serie)) %>% 
  ggplot(aes(x = variancia, y = mediana, color = serie)) + 
  geom_line() + 
  geom_point()

```



